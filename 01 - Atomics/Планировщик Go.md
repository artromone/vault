#prog_lang #prog_lang/golang #interview 

Управляет выполнением горутин, эффективно распределяет ресурсы, параллельные задачи

Иллюзия одновременного выполнения горутин, на деле это на ограниченном колве потоков ОС

![[Планировщик Go-1727202330015.jpeg]]

P – процессор – объединяет поток ОС (M) и очередь горутин. Определяется GOMAXPROCS

M – поток ос – выполняет горутины, каждый может выполнить одну горутину в любой момент времени

G – горуина – легковесный поток выполнения

Очереди выполнения:
- Глобальная – Содержит все горутины, готовые к выполнению
- Локальная – Каждому P соответствует локальная очередь горутин, назначенных на выполнение

Принципы работы планировщика:
- Если одна из локальных очередей пуста, P может украсть горутину из другой локальной очереди для повышения эффективности использования ресурсов
- Переключение между горутинами быстрее, чем между контекстом ОС
- Решения о переключении контекста на основе определенных событий в коде (вызов функций)
- Недетерминированный

---

Есть планировщик, который создает несколько машин, которые управляют горутинами
Количество машин создаваемых равно количеству процессоров на компе
Планировщик умный, периодически устраивает вытеснение задач (задача отправляется в самый конец и начинает выполнять следующую)
Есть локальная и глобальная очередь у каждой машины, если недозагруженность, можем взять задачу у горутины, у которой высокая загрузка
Стилинг – забираем задачи у работающих горутин в момент создания машины