#prog/golang #prog 

> Переменная, захваченная в замыкании, изменяется после создания замыкания, но до его выполнения

```go
package main

import (
    "fmt"
    "time"
)

func main() {
    for i := 0; i < 5; i++ {
        go func() {
            fmt.Println(i)
        }()
    }
    
    time.Sleep(time.Second) // Плохо, но ок. Даем горутинам время завершиться
}
```
Вместо ожидаемых `0 1 2 3 4` получим `5 5 5 5 5`

Горутины захватывают `i` по ссылке, к моменту выполнения горутин цикл завершится, `i` будет **5**

Если будем передавать как параметр, то на каждой итерации цикла будет новая переменная
```go
for i := 0; i < 5; i++ {
	go func(i int) {
		fmt.Println(i)
	}(i)
}
```

Проблема возникает до версии 1.21, после нее флаг, а после нее все норм #/todo 
