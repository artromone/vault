Структура `hmap` (header map) содержит метаданные и управляет бакетами

```go
type hmap struct {
    count     int       // Количество элементов (len(map)) :cite[10]
    B         uint8     // Логарифм количества бакетов (2^B) :cite[3]:cite[6]
    flags     uint8
    hash0     uint32    // Seed для хэш-функции (случайное значение) :cite[4]:cite[10]
    buckets   unsafe.Pointer // Указатель на массив бакетов :cite[6]
    oldbuckets unsafe.Pointer // Старые бакеты при рехешировании :cite[10]
    // ... другие поля (nevacuate, noverflow и т.д.)
}
```

Каждый бакет (`bmap`) хранит **до 8 пар ключ-значение**
```go
type bmap struct {
    tophash  [8]uint8     // Первые 8 бит хэша каждого ключа :cite[10]
    keys     [8]keytype   // Массив ключей
    values   [8]valuetype // Массив значений
    overflow *bmap        // Ссылка на overflow-бакет при коллизиях :cite[10]
}
```

- **`tophash`** ускоряет поиск: сначала проверяются эти биты, и только потом сравниваются ключи 611
- **Overflow-бакеты** образуют цепочки для разрешения коллизий (метод цепочек)

бакет – массив ключей, значений, быстрое определение ключа в бакете

экстра бакет – хранение пар ключ значение, когда основной бакет переполнен. связаны с основным бакетом через 

указатель. когда коллизия – новые элементы в экстрабакет. при изменении размера map из экстра бакетов могут перейти в обычные